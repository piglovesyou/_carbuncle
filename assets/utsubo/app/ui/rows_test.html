<!DOCTYPE HTML>
<html lang="en">
<head>
  <title>Closure Unit Tests - app.ui.Rows</title>
  <meta charset="UTF-8">

  <style type="text/css">
    .ui-rows {
      border: 1px #ccc solid;
      padding: 10px;
      margin-bottom: 40px;
    }
    .ui-rows-row {
      border: 1px #ccc solid;
      padding: 10px;
      margin-bottom: 10px;
    }
    .ui-rows-row:last-child {
      margin-bottom: 0;
    }

    .success-message {
      padding: 10px;
      font-weight: bold;
      color: green;
    }
  </style>

  <script src="../../../../libs/closure-library/closure/goog/base.js"></script>
  <script>
    goog.require('goog.ui.Component');
    goog.require('goog.testing.jsunit');
  </script>
  <script src="./rows.js"></script>

</head>
<body>


<div id="sandbox"></div>


<script>

	var sandbox = document.getElementById('sandbox');
	var rows, data;

  function setUp() {}

  function tearDown() {
    if (rows) rows.dispose();
    if (data) data.dispose();
    goog.dom.removeChildren(sandbox);
  }

  function testRender() {
    render();
    goog.asserts.assert(goog.dom.getChildren(rows.getContentElement()).length == 2);
  }

  function testRemove() {
    render();
    data.removeById('ohh')
    rows.redraw();

    goog.asserts.assert(goog.dom.getChildren(rows.getContentElement()).length == 1);
    goog.asserts.assert(goog.string.startsWith(goog.dom.getTextContent(rows.getContentElement()), 'boo'));
  }

  function testInsert() {
    render();

    data.removeById('ohh')
    data.insertAt({id: 'g2', title: 'g2 title', description: 'g2 description'}, 0);
    data.insertAt({id: 'g1', title: 'g1 title', description: 'g1 description'}, 0);
    data.insertAt({id: 'g0', title: 'g0 title', description: 'g0 description'}, 0);
    rows.redraw();

    goog.asserts.assert(goog.dom.getChildren(rows.getContentElement()).length == 4);
    goog.asserts.assert(goog.dom.getTextContent(rows.getContentElement()).match(/g0.*g1.*g2.*boo/));
  }

  function render() {
    rows = new app.ui.Rows(function(item) {
      return item.id + ', ' + item.title + ', ' + item.description;
    });
    data = new app.ui.Rows.Data('id');
    data.add({id: 'ohh', title: 'yeah', description: 'yyyyyyyyy'});
    data.add({id: 'boo', title: 'boo', description: 'boom'});
    rows.setData(data);
    rows.render(sandbox);
  }

</script>
</body>
</html>
